<?xml version="1.0" encoding="IBM437"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=IBM437" http-equiv="Content-Type" />

  <title>Class: MIME::Types</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/mime/types/cache_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/mime/types/cache.rb">lib/mime/types/cache.rb</a></li>
          
            <li><a href="../lib/mime/types_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/mime/types.rb">lib/mime/types.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">MODULE</span> <a href="Types/Cache.html">MIME::Types::Cache</a></li>
          
          <li><span class="type">CLASS</span> <a href="Types/Loader.html">MIME::Types::Loader</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-5B-5D">::[]</a></li>
          
          <li><a href="#method-c-add">::add</a></li>
          
          <li><a href="#method-c-cache_file">::cache_file</a></li>
          
          <li><a href="#method-c-count">::count</a></li>
          
          <li><a href="#method-c-each">::each</a></li>
          
          <li><a href="#method-c-load_from_file">::load_from_file</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-of">::of</a></li>
          
          <li><a href="#method-c-type_for">::type_for</a></li>
          
          <li><a href="#method-i-5B-5D">#[]</a></li>
          
          <li><a href="#method-i-add">#add</a></li>
          
          <li><a href="#method-i-add_type">#add_type</a></li>
          
          <li><a href="#method-i-count">#count</a></li>
          
          <li><a href="#method-i-each">#each</a></li>
          
          <li><a href="#method-i-of">#of</a></li>
          
          <li><a href="#method-i-type_for">#type_for</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><span class="include">Enumerable</span></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../Contributing_rdoc.html">Contributing.rdoc</a></li>
        
          <li class="file"><a href="../History-Types_rdoc.html">History-Types.rdoc</a></li>
        
          <li class="file"><a href="../History_rdoc.html">History.rdoc</a></li>
        
          <li class="file"><a href="../Licence_rdoc.html">Licence.rdoc</a></li>
        
          <li class="file"><a href="../Manifest_txt.html">Manifest.txt</a></li>
        
          <li class="file"><a href="../README_rdoc.html">README.rdoc</a></li>
        
          <li class="file"><a href="../docs/COPYING_txt.html">COPYING.txt</a></li>
        
          <li class="file"><a href="../docs/artistic_txt.html">artistic.txt</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../MIME.html">MIME</a></li>
        
          <li><a href="../MIME/Type.html">MIME::Type</a></li>
        
          <li><a href="../MIME/Type/InvalidContentType.html">MIME::Type::InvalidContentType</a></li>
        
          <li><a href="../MIME/Type/InvalidEncoding.html">MIME::Type::InvalidEncoding</a></li>
        
          <li><a href="../MIME/Types.html">MIME::Types</a></li>
        
          <li><a href="../MIME/Types/Cache.html">MIME::Types::Cache</a></li>
        
          <li><a href="../MIME/Types/Loader.html">MIME::Types::Loader</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">MIME::Types</h1>

    <div id="description" class="description">
      
<p><a href="Types.html">MIME::Types</a> is a registry of <a
href="../MIME.html">MIME</a> types. It is both a class (created with <a
href="Types.html#method-c-new">MIME::Types.new</a>) and a default registry
(loaded automatically or through interactions with <a
href="Types.html">MIME::Types</a>.[] and <a
href="Types.html#method-i-type_for">MIME::Types.type_for</a>).</p>

<h2>The Default mime-types Registry</h2>

<p>The default mime-types registry is loaded automatically when the library is
required (<tt>require 'mime/types'</tt>), but it may be lazily loaded
(loaded on first use) with the use of the environment variable
<tt>RUBY_MIME_TYPES_LAZY_LOAD</tt> having any value other than
<tt>false</tt>. The initial startup is about 14× faster (~10 ms vs ~140
ms), but the registry will be loaded at some point in the future.</p>

<p>The default mime-types registry can also be loaded from a Marshal cache
file specific to the version of <a href="Types.html">MIME::Types</a> being
loaded. This will be handled automatically with the use of a file referred
to in the environment variable <tt>RUBY_MIME_TYPES_CACHE</tt>. <a
href="Types.html">MIME::Types</a> will attempt to load the registry from
this cache file (MIME::Type::Cache.load); if it cannot be loaded (because
the file does not exist, there is an error, or the data is for a different
version of mime-types), the default registry will be loaded from the normal
JSON version and then the cache file will be <b>written</b> to the location
indicated by <tt>RUBY_MIME_TYPES_CACHE</tt>. <a
href="Types/Cache.html">Cache</a> file loads just over 4½× faster (~30 ms
vs ~140 ms). loads.</p>

<p>Notes:</p>
<ul><li>
<p>The loading of the default registry is <b>not</b> atomic; when using a
multi-threaded environment, it is recommended that lazy loading is not used
and mime-types is loaded as early as possible.</p>
</li><li>
<p><a href="Types/Cache.html">Cache</a> files should be specified per
application in a multiprocess environment and should be initialized during
deployment or before forking to minimize the chance that the multiple
processes will be trying to write to the same cache file at the same time,
or that two applications that are on different versions of mime-types would
be thrashing the cache.</p>
</li><li>
<p>Unless cache files are preinitialized, the application using the mime-types
cache file must have read/write permission to the cache file.</p>
</li></ul>

<h2>Usage</h2>

<pre>require 'mime/types'

plaintext = MIME::Types['text/plain']
print plaintext.media_type           # =&gt; 'text'
print plaintext.sub_type             # =&gt; 'plain'

puts plaintext.extensions.join(&quot; &quot;)  # =&gt; 'asc txt c cc h hh cpp'

puts plaintext.encoding              # =&gt; 8bit
puts plaintext.binary?               # =&gt; false
puts plaintext.ascii?                # =&gt; true
puts plaintext.obsolete?             # =&gt; false
puts plaintext.registered?           # =&gt; true
puts plaintext == 'text/plain'       # =&gt; true
puts MIME::Type.simplified('x-appl/x-zip') # =&gt; 'appl/zip'</pre>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="Cache">Cache</a></dt>
          
          <dd class="description"><p>Caching of <a href="Types.html">MIME::Types</a> registries is advisable if
you will be loading the default registry relatively frequently. With the
class methods on <a href="Types/Cache.html">MIME::Types::Cache</a>, any <a
href="Types.html">MIME::Types</a> registry can be marshaled quickly and
easily.</p>

<p>The cache is invalidated on a per-version basis; a cache file for version
2.0 will not be reused with version 2.0.1.</p></dd>
          
        
          <dt><a name="VERSION">VERSION</a></dt>
          
          <dd class="description"><p>The release version of Ruby <a href="Types.html">MIME::Types</a></p></dd>
          
        
        </dl>
      </div>
      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="data_version-attribute-method" class="method-detail">
          <a name="data_version"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">data_version</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>The data version.</p>
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="5B-5D-method" class="method-detail ">
          <a name="method-c-5B-5D"></a>

          
          <div class="method-heading">
            <span class="method-name">[]</span><span
              class="method-args">(type_id, flags = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>MIME::Types#[] against the default <a href="Types.html">MIME::Types</a>
registry.</p>
            

            
            <div class="method-source-code" id="5B-5D-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 228</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">type_id</span>, <span class="ruby-identifier">flags</span> = {})
  <span class="ruby-identifier">__types__</span>[<span class="ruby-identifier">type_id</span>, <span class="ruby-identifier">flags</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- 5B-5D-source -->
            
          </div>

          

          
        </div><!-- 5B-5D-method -->

      
        <div id="add-method" class="method-detail ">
          <a name="method-c-add"></a>

          
          <div class="method-heading">
            <span class="method-name">add</span><span
              class="method-args">(*types)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p><a href="Types.html#method-i-add">MIME::Types#add</a> against the default
<a href="Types.html">MIME::Types</a> registry.</p>
            

            
            <div class="method-source-code" id="add-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(*<span class="ruby-identifier">types</span>)
  <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">add</span>(*<span class="ruby-identifier">types</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- add-source -->
            
          </div>

          

          
        </div><!-- add-method -->

      
        <div id="cache_file-method" class="method-detail ">
          <a name="method-c-cache_file"></a>

          
          <div class="method-heading">
            <span class="method-name">cache_file</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the currently defined cache file, if any.</p>
            

            
            <div class="method-source-code" id="cache_file-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_file</span>
  <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>)
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">'RUBY_MIME_TYPES_CACHE'</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- cache_file-source -->
            
          </div>

          

          
        </div><!-- cache_file-method -->

      
        <div id="count-method" class="method-detail ">
          <a name="method-c-count"></a>

          
          <div class="method-heading">
            <span class="method-name">count</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p><a href="Types.html#method-i-count">MIME::Types#count</a> against the
default <a href="Types.html">MIME::Types</a> registry.</p>
            

            
            <div class="method-source-code" id="count-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 233</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">count</span>
  <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- count-source -->
            
          </div>

          

          
        </div><!-- count-method -->

      
        <div id="each-method" class="method-detail ">
          <a name="method-c-each"></a>

          
          <div class="method-heading">
            <span class="method-name">each</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p><a href="Types.html#method-i-each">MIME::Types#each</a> against the default
<a href="Types.html">MIME::Types</a> registry.</p>
            

            
            <div class="method-source-code" id="each-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 238</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>
  <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">t</span> }
<span class="ruby-keyword">end</span></pre>
            </div><!-- each-source -->
            
          </div>

          

          
        </div><!-- each-method -->

      
        <div id="load_from_file-method" class="method-detail ">
          <a name="method-c-load_from_file"></a>

          
          <div class="method-heading">
            <span class="method-name">load_from_file</span><span
              class="method-args">(filename)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Load <a href="Types.html">MIME::Types</a> from a v1 file registry.</p>

<p>This method has been deprecated.</p>
            

            
            <div class="method-source-code" id="load_from_file-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 222</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_from_file</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>)
  <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Loader</span>.<span class="ruby-identifier">load_from_v1</span>(<span class="ruby-identifier">filename</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_from_file-source -->
            
          </div>

          

          
        </div><!-- load_from_file-method -->

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a new <a href="Types.html">MIME::Types</a> registry.</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 71</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-ivar">@type_variants</span>    = <span class="ruby-constant">Container</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@extension_index</span>  = <span class="ruby-constant">Container</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@data_version</span>     = <span class="ruby-constant">VERSION</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">freeze</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
        <div id="of-method" class="method-detail method-alias">
          <a name="method-c-of"></a>

          
          <div class="method-heading">
            <span class="method-name">of</span><span
              class="method-args">(filename, platform = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Types.html#method-c-type_for">type_for</a>
          </div>
          
        </div><!-- of-method -->

      
        <div id="type_for-method" class="method-detail ">
          <a name="method-c-type_for"></a>

          
          <div class="method-heading">
            <span class="method-name">type_for</span><span
              class="method-args">(filename, platform = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p><a href="Types.html#method-i-type_for">MIME::Types#type_for</a> against the
default <a href="Types.html">MIME::Types</a> registry.</p>
            

            
            <div class="method-source-code" id="type_for-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">type_for</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">platform</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">type_for</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">platform</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- type_for-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Types.html#method-c-of">of</a>
          </div>
          

          
        </div><!-- type_for-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="5B-5D-method" class="method-detail ">
          <a name="method-i-5B-5D"></a>

          
          <div class="method-heading">
            <span class="method-name">[]</span><span
              class="method-args">(type_id, flags = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a list of <a href="Type.html">MIME::Type</a> objects, which may be
empty. The optional flag parameters are <tt>:complete</tt> (finds only
complete <a href="Type.html">MIME::Type</a> objects) and
<tt>:registered</tt> (finds only <a href="Types.html">MIME::Types</a> that
are registered). It is possible for multiple matches to be returned for
either type (in the example below, 'text/plain' returns two values -- one
for the general case, and one for VMS systems).</p>

<pre>puts &quot;\nMIME::Types['text/plain']&quot;
MIME::Types['text/plain'].each { |t| puts t.to_a.join(&quot;, &quot;) }

puts &quot;\nMIME::Types[/^image/, complete: true]&quot;
MIME::Types[/^image/, :complete =&gt; true].each do |t|
  puts t.to_a.join(&quot;, &quot;)
end</pre>

<p>If multiple type definitions are returned, returns them sorted as follows:</p>

<pre>1. Complete definitions sort before incomplete ones;
2. IANA-registered definitions sort before LTSW-recorded
   definitions.
3. Generic definitions sort before platform-specific ones;
4. Current definitions sort before obsolete ones;
5. Obsolete definitions with use-instead clauses sort before those
   without;
6. Obsolete definitions use-instead clauses are compared.
7. Sort on name.</pre>

<p>An additional flag of :platform (finds only <a
href="Types.html">MIME::Types</a> for the current platform) is currently
supported but deprecated.</p>
            

            
            <div class="method-source-code" id="5B-5D-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 133</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">type_id</span>, <span class="ruby-identifier">flags</span> = {})
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-value">:platform</span>]
    <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>, <span class="ruby-string">&quot;using the :platform flag&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">matches</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">type_id</span>
            <span class="ruby-keyword">when</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>
              <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">type_id</span>.<span class="ruby-identifier">simplified</span>]
            <span class="ruby-keyword">when</span> <span class="ruby-constant">Regexp</span>
              <span class="ruby-identifier">match</span>(<span class="ruby-identifier">type_id</span>)
            <span class="ruby-keyword">else</span>
              <span class="ruby-ivar">@type_variants</span>[<span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>.<span class="ruby-identifier">simplified</span>(<span class="ruby-identifier">type_id</span>)]
            <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">prune_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">flags</span>).<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">priority_compare</span>(<span class="ruby-identifier">b</span>) }
<span class="ruby-keyword">end</span></pre>
            </div><!-- 5B-5D-source -->
            
          </div>

          

          
        </div><!-- 5B-5D-method -->

      
        <div id="add-method" class="method-detail ">
          <a name="method-i-add"></a>

          
          <div class="method-heading">
            <span class="method-name">add</span><span
              class="method-args">(*types)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Add one or more <a href="Type.html">MIME::Type</a> objects to the set of
known types. If the type is already known, a warning will be displayed.</p>

<p>The last parameter may be the value <tt>:silent</tt> or <tt>true</tt> which
will suppress duplicate <a href="../MIME.html">MIME</a> type warnings.</p>
            

            
            <div class="method-source-code" id="add-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 185</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(*<span class="ruby-identifier">types</span>)
  <span class="ruby-identifier">quiet</span> = ((<span class="ruby-identifier">types</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-value">:silent</span>) <span class="ruby-keyword">or</span> (<span class="ruby-identifier">types</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>))

  <span class="ruby-identifier">types</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">mime_type</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">mime_type</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">true</span>, <span class="ruby-keyword">false</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-constant">Symbol</span>
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>
      <span class="ruby-identifier">variants</span> = <span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-value">:@type_variants</span>)
      <span class="ruby-identifier">add</span>(*<span class="ruby-identifier">variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">flatten</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
      <span class="ruby-identifier">add</span>(*<span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">add_type</span>(<span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- add-source -->
            
          </div>

          

          
        </div><!-- add-method -->

      
        <div id="add_type-method" class="method-detail ">
          <a name="method-i-add_type"></a>

          
          <div class="method-heading">
            <span class="method-name">add_type</span><span
              class="method-args">(mime_type, quiet = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Add a single <a href="Type.html">MIME::Type</a> object to the set of known
types. If the type is already known, a warning will be displayed. The
<tt>quiet</tt> parameter may be a truthy value to suppress that warning.</p>
            

            
            <div class="method-source-code" id="add_type-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 206</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_type</span>(<span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">quiet</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">simplified</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">mime_type</span>)
    <span class="ruby-identifier">warn</span>(<span class="ruby-string">&quot;Type %s is already registered as a variant of %s.&quot;</span> <span class="ruby-operator">%</span> [
      <span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">simplified</span> ])
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">add_type_variant!</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-identifier">index_extensions!</span>(<span class="ruby-identifier">mime_type</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- add_type-source -->
            
          </div>

          

          
        </div><!-- add_type-method -->

      
        <div id="count-method" class="method-detail ">
          <a name="method-i-count"></a>

          
          <div class="method-heading">
            <span class="method-name">count</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the number of known type variants.</p>
            

            
            <div class="method-source-code" id="count-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 93</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">reduce</span>(<span class="ruby-value">0</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">size</span> }
<span class="ruby-keyword">end</span></pre>
            </div><!-- count-source -->
            
          </div>

          

          
        </div><!-- count-method -->

      
        <div id="each-method" class="method-detail ">
          <a name="method-i-each"></a>

          
          <div class="method-heading">
            <span class="method-name">each</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Iterates through the type variants.</p>
            

            
            <div class="method-source-code" id="each-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>
  <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">tv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tv</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">t</span> } }
<span class="ruby-keyword">end</span></pre>
            </div><!-- each-source -->
            
          </div>

          

          
        </div><!-- each-method -->

      
        <div id="of-method" class="method-detail method-alias">
          <a name="method-i-of"></a>

          
          <div class="method-heading">
            <span class="method-name">of</span><span
              class="method-args">(filename, platform = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Types.html#method-i-type_for">type_for</a>
          </div>
          
        </div><!-- of-method -->

      
        <div id="type_for-method" class="method-detail ">
          <a name="method-i-type_for"></a>

          
          <div class="method-heading">
            <span class="method-name">type_for</span><span
              class="method-args">(filename, platform = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Return the list of <a href="Types.html">MIME::Types</a> which belongs to
the file based on its filename extension. If there is no extension, the
filename will be used as the matching criteria on its own.</p>

<p>This will always return a merged, flatten, priority sorted, unique array.</p>

<pre>puts MIME::Types.type_for('citydesk.xml')
  =&gt; [application/xml, text/xml]
puts MIME::Types.type_for('citydesk.gif')
  =&gt; [image/gif]
puts MIME::Types.type_for(%w(citydesk.xml citydesk.gif))
  =&gt; [application/xml, image/gif, text/xml]</pre>

<p>If <tt>platform</tt> is <tt>true</tt>, then only file types that are
specific to the current platform will be returned. This parameter has been
deprecated.</p>
            

            
            <div class="method-source-code" id="type_for-source">
<pre>
<span class="ruby-comment"># File lib/mime/types.rb, line 165</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">type_for</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">platform</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">types</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">flat_map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">fn</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@extension_index</span>[<span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">fn</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">downcase</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/.*\./</span>, <span class="ruby-string">''</span>)]
  }.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">priority_compare</span>(<span class="ruby-identifier">b</span>) }.<span class="ruby-identifier">uniq</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">platform</span>
    <span class="ruby-constant">MIME</span>.<span class="ruby-identifier">deprecated</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">__method__</span>,
                    <span class="ruby-string">&quot;using the platform parameter&quot;</span>)
    <span class="ruby-identifier">types</span>.<span class="ruby-identifier">select</span>(&amp;<span class="ruby-value">:platform?</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">types</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- type_for-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Types.html#method-i-of">of</a>
          </div>
          

          
        </div><!-- type_for-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

